From e37bbc424fd7ad99f2468a443b3d17200a8006aa Mon Sep 17 00:00:00 2001
From: Jens Reidel <jens@troet.org>
Date: Fri, 9 Oct 2020 13:49:04 +0200
Subject: [PATCH] Patch packed_simd stuff

---
 Cargo.lock | 27 ++++++++++++++++-----------
 Cargo.toml |  4 ++--
 2 files changed, 18 insertions(+), 13 deletions(-)

diff --git a/Cargo.lock b/Cargo.lock
index 24d8974..4d89e1f 100644
--- a/Cargo.lock
+++ b/Cargo.lock
@@ -21,10 +21,9 @@ checksum = "cf1de2fe8c75bc145a2f577add951f8134889b4795d47466a54a5c846d691693"
 [[package]]
 name = "bytecount"
 version = "0.6.0"
-source = "registry+https://github.com/rust-lang/crates.io-index"
-checksum = "b0017894339f586ccb943b01b9555de56770c11cda818e7e3d8bd93f4ed7f46e"
+source = "git+https://github.com/llogiq/bytecount.git#469eaf8395c99397cd64d059737a9054aa014088"
 dependencies = [
- "packed_simd",
+ "packed_simd_2",
 ]
 
 [[package]]
@@ -45,11 +44,10 @@ dependencies = [
 [[package]]
 name = "encoding_rs"
 version = "0.8.24"
-source = "registry+https://github.com/rust-lang/crates.io-index"
-checksum = "a51b8cf747471cb9499b6d59e59b0444f4c90eba8968c4e44874e92b5b64ace2"
+source = "git+https://github.com/hsivonen/encoding_rs.git#8f76bfe6752f66d699e5c9e1c0127575c4d990a6"
 dependencies = [
  "cfg-if",
- "packed_simd",
+ "packed_simd_2",
 ]
 
 [[package]]
@@ -88,9 +86,15 @@ dependencies = [
 
 [[package]]
 name = "libc"
-version = "0.2.77"
+version = "0.2.79"
+source = "registry+https://github.com/rust-lang/crates.io-index"
+checksum = "2448f6066e80e3bfc792e9c98bf705b4b0fc6e8ef5b43e5889aff0eaa9c58743"
+
+[[package]]
+name = "libm"
+version = "0.1.4"
 source = "registry+https://github.com/rust-lang/crates.io-index"
-checksum = "f2f96b10ec2560088a8e76961b00d47107b3a625fecb76dedb29ee7ccbf98235"
+checksum = "7fc7aa29613bd6a620df431842069224d8bc9011086b1db4c0e0cd47fa03ec9a"
 
 [[package]]
 name = "lock_api"
@@ -126,12 +130,13 @@ dependencies = [
 ]
 
 [[package]]
-name = "packed_simd"
-version = "0.3.3"
+name = "packed_simd_2"
+version = "0.3.4"
 source = "registry+https://github.com/rust-lang/crates.io-index"
-checksum = "a85ea9fc0d4ac0deb6fe7911d38786b32fc11119afd9e9d38b84ff691ce64220"
+checksum = "3278e0492f961fd4ae70909f56b2723a7e8d01a228427294e19cdfdebda89a17"
 dependencies = [
  "cfg-if",
+ "libm",
 ]
 
 [[package]]
diff --git a/Cargo.toml b/Cargo.toml
index 56a99ea..abdd478 100644
--- a/Cargo.toml
+++ b/Cargo.toml
@@ -50,8 +50,8 @@ classifier = [
 
 [dependencies]
 associative-cache = { version = "1" }
-bytecount = { version = "0.6", default_features = false, features = ["generic-simd", "runtime-dispatch-simd"] }
-encoding_rs = { version = "0.8", default_features = false, features = ["simd-accel"] }
+bytecount = { git = "https://github.com/llogiq/bytecount.git", default_features = false, features = ["generic-simd", "runtime-dispatch-simd"] }
+encoding_rs = { git = "https://github.com/hsivonen/encoding_rs.git", default_features = false, features = ["simd-accel"] }
 inlinable_string = { version = "0.1" }
 itoa = { version = "0.4", default_features = false }
 once_cell = { version = "1", default_features = false }
-- 
2.26.2

